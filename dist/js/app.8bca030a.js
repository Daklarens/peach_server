(function(){"use strict";var e={1156:function(e,t,a){var n=a(5130),o=a(6768);const r=e=>((0,o.Qi)("data-v-27041bf1"),e=e(),(0,o.jt)(),e),s={id:"app"},l={key:0,class:"loading"},i=r((()=>(0,o.Lk)("div",{class:"gradient-div"},[(0,o.Lk)("p",{class:"position-absolute top-0 start-50 translate-middle-x"},"v.1.0"),(0,o.Lk)("div",{class:"spinner-border text-light lst",role:"status"}),(0,o.Lk)("p",{class:"position-absolute bottom-0 start-50 translate-middle-x"},"Loading...")],-1))),u=[i],c={key:1},d={key:0,class:"fixed-bottom navbar-expand-sm bg-light"},p={class:"nav nav-pills nav-fill gap-2 p-2 small rounded-1 shadow-sm colorss",role:"tablist",style:{"--bs-nav-link-color":"#ff7e5f","--bs-nav-pills-link-active-color":"#fff","--bs-nav-pills-link-active-bg":"#ff7e5f"}},m=r((()=>(0,o.Lk)("i",{class:"bi bi-envelope-open nav-link rounded-5","data-bs-toggle":"tab",type:"button",role:"tab","aria-selected":"true",style:{"font-size":"1.5rem"}},null,-1))),h=[m],v=r((()=>(0,o.Lk)("i",{class:"bi bi-arrow-through-heart-fill nav-link active rounded-5","data-bs-toggle":"tab",type:"button",role:"tab","aria-selected":"true",style:{"font-size":"1.5rem"}},null,-1))),f=[v],b=r((()=>(0,o.Lk)("i",{class:"bi bi-chat-heart nav-link rounded-5","data-bs-toggle":"tab",type:"button",role:"tab","aria-selected":"true",style:{"font-size":"1.5rem"}},null,-1))),g=[b],k=r((()=>(0,o.Lk)("i",{class:"bi bi-person-fill nav-link rounded-5","data-bs-toggle":"tab",type:"button",role:"tab","aria-selected":"true"},null,-1))),L=[k];function y(e,t,a,n,r,i){return(0,o.uX)(),(0,o.CE)("div",s,[((0,o.uX)(),(0,o.Wv)((0,o.$y)(e.currentComponent))),r.loading?((0,o.uX)(),(0,o.CE)("div",l,u)):((0,o.uX)(),(0,o.CE)("div",c,[r.userConnect?((0,o.uX)(),(0,o.CE)("nav",d,[(0,o.Lk)("ul",p,[(0,o.Lk)("li",{class:"nav-item",onClick:t[0]||(t[0]=e=>i.loadComponent("Repost")),role:"presentation"},h),(0,o.Lk)("li",{class:"nav-item",onClick:t[1]||(t[1]=e=>i.loadComponent("anketsNew")),role:"presentation"},f),(0,o.Lk)("li",{class:"nav-item",onClick:t[2]||(t[2]=e=>i.loadComponent("Chat")),role:"presentation"},g),(0,o.Lk)("li",{class:"nav-item",onClick:t[3]||(t[3]=e=>i.loadComponent("editPerson")),role:"presentation"},L)])])):(0,o.Q3)("",!0)]))])}a(1373);const C="https://podryvanov.ru/api/users";async function w(e,t={}){const a=`${C}${e}`,n={headers:{"Content-Type":"application/json"},...t};try{const e=await fetch(a,n);if(!e.ok)throw new Error(`Ошибка: ${e.status} ${e.statusText}`);return await e.json()}catch(o){throw console.error("Ошибка при выполнении запроса:",o),o}}async function x(e,t){return w(e,{method:"POST",body:JSON.stringify(t)})}async function D(e,t){return w(e,{method:"POST",body:t})}var A=a(782);const T=e=>((0,o.Qi)("data-v-44e65e3c"),e=e(),(0,o.jt)(),e),_={class:"container messDiv"},I={class:"p-5 rounded mt-3"},E={class:"col-md-7 col-lg-8"},O={class:"profile-header"},S=["src"],U=T((()=>(0,o.Lk)("h4",{class:"mb-3 text-center"},"Заполните ваш профиль",-1))),j={class:"row g-3"},F={class:"col-12"},N=T((()=>(0,o.Lk)("label",{for:"firstName",class:"form-label"},"Ваше имя",-1))),P={class:"col-md-5"},$=T((()=>(0,o.Lk)("label",{for:"birthdate",class:"form-label"},"Дата рождения",-1))),J=["max"],X={class:"col-md-5"},q=T((()=>(0,o.Lk)("label",{class:"form-label"},"Ваш пол",-1))),z=T((()=>(0,o.Lk)("option",{value:""},"Выбор ...",-1))),R=T((()=>(0,o.Lk)("option",{value:"1"},"Мужчина",-1))),V=T((()=>(0,o.Lk)("option",{value:"2"},"Девушка",-1))),B=[z,R,V],Q={class:"col-12"},W=T((()=>(0,o.Lk)("label",{for:"about",class:"form-label"},"Описание",-1))),G={class:"col-md-5"},H=T((()=>(0,o.Lk)("label",{class:"form-label"},"Вы ищите",-1))),K=T((()=>(0,o.Lk)("option",{value:""},"Выбор ...",-1))),Y=T((()=>(0,o.Lk)("option",{value:"2"},"Девушек",-1))),Z=T((()=>(0,o.Lk)("option",{value:"1"},"Мужчин",-1))),M=[K,Y,Z],ee=T((()=>(0,o.Lk)("hr",{class:"my-4"},null,-1))),te=T((()=>(0,o.Lk)("button",{class:"w-100 btn btn-lg",type:"submit"},"Сохранить",-1))),ae=T((()=>(0,o.Lk)("br",null,null,-1))),ne=T((()=>(0,o.Lk)("br",null,null,-1))),oe=T((()=>(0,o.Lk)("br",null,null,-1))),re=T((()=>(0,o.Lk)("br",null,null,-1)));function se(e,t,r,s,l,i){return(0,o.uX)(),(0,o.CE)("main",_,[(0,o.Lk)("div",I,[(0,o.Lk)("div",E,[(0,o.Lk)("div",O,[(0,o.Lk)("img",{src:e.user.avatar||a(8026),alt:"Avatar",onClick:t[0]||(t[0]=(...e)=>i.triggerFileInput&&i.triggerFileInput(...e)),style:{cursor:"pointer",border:"5px solid","border-color":"aliceblue"}},null,8,S)]),U,(0,o.Lk)("form",{onSubmit:t[10]||(t[10]=(0,n.D$)(((...e)=>i.handleSubmit&&i.handleSubmit(...e)),["prevent"])),class:"needs-validation"},[(0,o.Lk)("div",j,[(0,o.Lk)("div",F,[N,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.user.name=t),type:"text",class:"form-control",placeholder:"",required:"",onInput:t[2]||(t[2]=(...e)=>i.validateName&&i.validateName(...e)),title:"Только буквы и пробелы"},null,544),[[n.Jo,e.user.name]])]),(0,o.Lk)("div",P,[$,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.user.birthdate=t),type:"date",class:"form-control",required:"",max:l.maxDate,onChange:t[4]||(t[4]=(...e)=>i.validateBirthdate&&i.validateBirthdate(...e))},null,40,J),[[n.Jo,e.user.birthdate]])]),(0,o.Lk)("div",X,[q,(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.user.sex=t),class:"form-select",id:"sex",required:""},B,512),[[n.u1,e.user.sex]])]),(0,o.Lk)("div",Q,[W,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[6]||(t[6]=t=>e.user.about=t),type:"text",class:"form-control",placeholder:"Люблю гулять по Москве",required:"",onInput:t[7]||(t[7]=(...e)=>i.validateAbout&&i.validateAbout(...e)),title:"Только буквы и пробелы"},null,544),[[n.Jo,e.user.about]])]),(0,o.Lk)("div",G,[H,(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.user.searchsex=t),class:"form-select",id:"search",required:""},M,512),[[n.u1,e.user.searchsex]])])]),(0,o.Lk)("input",{type:"file",ref:"fileInput",style:{display:"none"},onChange:t[9]||(t[9]=(...e)=>i.handleFileChange&&i.handleFileChange(...e)),accept:"image/png, image/jpeg, image/jpg"},null,544),ee,te],32)])]),ae,ne,oe,re])}var le={name:"createPerson",data(){return{event_avatar:"",tg:window.Telegram.WebApp,maxDate:(new Date).toISOString().split("T")[0]}},computed:{...(0,A.aH)(["user"])},methods:{...(0,A.i0)(["updateUserData"]),triggerFileInput(){this.$refs.fileInput.click()},handleSubmit(){this.updateUserData(this.user),this.user.name&&this.user.avatar&&this.user.searchsex&&this.user.sex?this.uploadImage():(console.log(this.user),console.log("Данных не хватает для создания анкеты"))},validateName(){this.user.name=this.user.name.replace(/[^A-Za-zА-Яа-яЁё\s]/g,"")},validateAbout(){this.user.about=this.user.about.replace(/[^A-Za-zА-Яа-яЁё\s]/g,"")},validateBirthdate(){new Date(this.user.birthdate).getFullYear(),(new Date).getFullYear()},handleFileChange(e){const t=e.target.files[0];t&&["image/jpeg","image/png","image/jpg"].includes(t.type)?(this.previewImage(t),this.event_avatar=t):alert("Only JPG and PNG files are allowed!")},previewImage(e){const t=new FileReader;t.onload=e=>{this.user.avatar=e.target.result},t.readAsDataURL(e)},uploadImage(){if(!this.user.avatar)return void alert("Пожалуйста, выберите изображение для загрузки.");const{avatar:e,...t}=this.user,a=new FormData;a.append("avatar",e),a.append("data",JSON.stringify(t)),D("/upload",a,"noJson").then((e=>{console.log(e),e.message&&(this.user.id=e.newId,this.user.token=e.token,alert("Успешно"))})).catch((e=>{alert("Ошибка при загрузке"),console.error("Error:",e)}))}}},ie=a(1241);const ue=(0,ie.A)(le,[["render",se],["__scopeId","data-v-44e65e3c"]]);var ce=ue,de={name:"App",components:{createPerson:ce},data(){return{loading:!0,userConnect:!1,tg:window.Telegram.WebApp}},computed:{...(0,A.aH)(["user","anket","currentComponent"])},methods:{...(0,A.i0)(["updateUserData","updateAnketData","changeComponent"]),async loaderInfo(){try{const e=await x("/",{initData:this.tg.initData,initDataUnsafe:this.tg.initDataUnsafe,platform:this.tg.platform});e.user?(this.updateUserData(e.user),this.updateUserData({token:e.token}),this.updateAnketData(e.ankets),this.loading=!1,this.userConnect=!0):(this.updateUserData({token:e.token}),this.loading=!1,this.userConnect=!1,this.loadComponent("createPerson"))}catch(e){console.error("Ошибка загрузки данных:",e)}},loadComponent(e){this.changeComponent(e)}},mounted(){this.loaderInfo()}};const pe=(0,ie.A)(de,[["render",y],["__scopeId","data-v-27041bf1"]]);var me=pe;const he=(0,A.y$)({state:{currentComponent:null,anket:{id:null,name:"",age:"",about:"",img_main:"",currentId:1,statusSearch:null},user:{id:null,name:"",age:null,avatar:"",searchsex:"",sex:"",about:"",token:""}},mutations:{setCurrentComponent(e,t){e.currentComponent=t},SET_ANKET_DATA(e,t){e.anket=t},SET_USER_DATA(e,t){e.user=t}},actions:{changeComponent({commit:e},t){e("setCurrentComponent",t)},updateAnketData({commit:e},t){e("SET_ANKET_DATA",t)},updateUserData({commit:e},t){e("SET_USER_DATA",t)}}});var ve=he;const fe=(0,n.Ef)(me);fe.use(ve),fe.mount("#app")},8026:function(e,t,a){e.exports=a.p+"img/noAvatar.9d0dc018.jpg"}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,n,o,r){if(!n){var s=1/0;for(c=0;c<e.length;c++){n=e[c][0],o=e[c][1],r=e[c][2];for(var l=!0,i=0;i<n.length;i++)(!1&r||s>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[i])}))?n.splice(i--,1):(l=!1,r<s&&(s=r));if(l){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[n,o,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.p="/"}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,r,s=n[0],l=n[1],i=n[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(i)var c=i(a)}for(t&&t(n);u<s.length;u++)r=s[u],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(c)},n=self["webpackChunkpeach_client"]=self["webpackChunkpeach_client"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(1156)}));n=a.O(n)})();
//# sourceMappingURL=app.8bca030a.js.map